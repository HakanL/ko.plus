/*=============================================================================
 *   Author:      Steve Greatrex - @stevegreatrex                               
 *                                                                              
 *   Description: Helper extensions for KnockoutJs                              
 *=============================================================================*/

!function(a){"use strict";!function(b){"function"==typeof define&&define.amd?define("ko.plus",["jquery","knockout"],b):b(a.jQuery,a.ko)}(function(a,b){!function(a,b){function c(b,c){var d=a.Deferred();return b?d.resolve(c):d.reject(c),d}b.command=function(a){if("function"==typeof a&&(a={action:a}),!a)throw"No options were specified";if(!a.action)throw"No action was specified in the options";var d,e=b.observable(!1),f=b.observable(!1),g={done:[],fail:[function(){f(!0)}],always:[function(){e(!1),d=null}]},h=function(){d&&d.abort&&"abortPendingRequest"===a.concurrentExecution&&d.abort()},i=function(){if(h(),!k())return c(!1).promise();e(!0),f(!1);var b;try{b=a.action.apply(i,arguments),b&&b.done&&b.always&&b.fail||(b=c(!0,b).promise())}catch(j){b=c(!1,j).promise()}return b.always(g.always).fail(g.fail).done(g.done),d=b},j=b.observable(),k=b.computed(function(){return j(),!(e()&&"abortPendingRequest"!==a.concurrentExecution||"undefined"!=typeof a.canExecute&&!a.canExecute.call(i))},i),l=function(){j.notifySubscribers()},m=function(a){return g.done.push(a),i},n=function(a){return g.fail.push(a),i},o=function(a){return g.always.push(a),i};return a.done&&g.done.push(a.done),a.fail&&g.fail.push(a.fail),i.isRunning=e,i.canExecute=k,i.canExecuteHasMutated=l,i.done=m,i.fail=n,i.always=o,i.failed=f,i}}(jQuery,b),function(a){function b(b,c){var d=[];return c=c||function(a){return a()},b.isEditing=a.observable(!1),b.beginEdit=function(){b.isEditing()||(d.push(c(b)),b.isEditing(!0))},b.endEdit=function(){b.isEditing()&&b.isEditing(!1)},b.cancelEdit=function(){b.isEditing()&&d.length&&(b(d.pop()),b.isEditing(!1))},b.rollback=function(){d.length&&b(d.pop())},b}a.editable=function(c){return b(a.observable(c))},a.editableArray=function(c){return b(a.observableArray(c),function(a){return a.slice()})};var c=function(b,c){for(var d in b)if(b.hasOwnProperty(d)){var e=b[d];e&&e.isEditing&&c(e);var f=a.utils.unwrapObservable(e);if(f&&f.length)for(var g=0;g<f.length;g++)f[g]&&f[g].isEditing&&c(f[g])}};a.editable.makeEditable=function(b){if(!b)throw"Target must be specified";b.isEditing=a.observable(!1),b.beginEdit=function(){(!b.isEditable||b.isEditable())&&(c(b,function(a){a.beginEdit()}),b.isEditing(!0))},b.endEdit=function(){c(b,function(a){a.endEdit()}),b.isEditing(!1)},b.cancelEdit=function(){c(b,function(a){a.cancelEdit()}),b.isEditing(!1)},b.rollback=function(){c(b,function(a){a.rollback()})}}}(b),function(a,b){b.bindingHandlers.loadingWhen={init:function(c,d,e){var f=b.utils.unwrapObservable(e()).loaderClass||"loader-white",g=a(c),h=g.css("position"),i=a("<div>",{"class":f}).addClass("loader").hide();g.append(i),("auto"===h||"static"===h)&&g.css("position","relative"),i.css({position:"absolute",top:"50%",left:"50%","margin-left":-(i.width()/2)+"px","margin-top":-(i.height()/2)+"px"})},update:function(c,d){var e=b.utils.unwrapObservable(d()),f=a(c),g=f.children(":not(div.loader)"),h=f.find("div.loader");e?(g.css("visibility","hidden").attr("disabled","disabled"),h.show()):(h.fadeOut("fast"),g.css("visibility","visible").removeAttr("disabled"))}}}(jQuery,b)})}(window);