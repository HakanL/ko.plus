/*=============================================================================
 *   Author:      Steve Greatrex - @stevegreatrex                               
 *                                                                              
 *   Description: Awesome extensions for KnockoutJs                              
 *=============================================================================*/

!function(a,b){"use strict";!function(b){"function"==typeof define&&define.amd?define("ko.plus",["jquery","knockout"],b):b(a.jQuery,a.ko)}(function(a,c){!function(a,b){function c(b,c,d){var e=a.Deferred();return b?e.resolveWith(d,[c]):e.rejectWith(d,[c]),e}b.command=function(a){if("function"==typeof a&&(a={action:a}),!a)throw"No options were specified";if(!a.action)throw"No action was specified in the options";var d=b.observable(!1),e=b.observable(),f=b.observable(""),g=b.observable(!1),h={done:[],fail:[function(){e(!0)}],always:[function(){d(!1)}]},i=function(){if(!k.call(a.context||this))return c(!1,null,a.context||this).promise();d(!0),e(!1),f("");var b;try{b=a.action.apply(a.context||this,arguments),b&&b.done&&b.always&&b.fail||(b=c(!0,b,a.context||this).promise())}catch(i){b=c(!1,i,a.context||this).promise()}return b.always(h.always,function(){g(!0)}).fail(h.fail).done(h.done),b},j=b.observable(),k=a.canExecute||function(){return!0},l=b.computed({deferEvaluation:!0,read:function(){return j(),!d()&&k.call(a.context||this)}},a.context||this),m=function(){j.notifySubscribers()},n=function(a){return h.done.push(a),i},o=function(a){return h.fail.push(function(){var b=a.apply(this,arguments);b&&f(b)}),i},p=function(a){return h.always.push(a),i};return a.done&&h.done.push(a.done),a.fail&&h.fail.push(a.fail),i.isRunning=d,i.canExecute=l,i.canExecuteHasMutated=m,i.done=n,i.fail=o,i.failMessage=f,i.always=p,i.failed=e,i.completed=g,i},b.bindingHandlers.command={init:function(a,c,d){var e=b.utils.unwrapObservable(c());b.bindingHandlers.loadingWhen.init.call(this,a,e.isRunning,d),b.bindingHandlers.click.init.call(this,a,b.observable(e),d)},update:function(a,c,d){var e=b.utils.unwrapObservable(c());b.bindingHandlers.loadingWhen.update.call(this,a,e.isRunning,d),b.bindingHandlers.enable.update.call(this,a,e.canExecute,d)}}}(jQuery,c),function(a){function c(c,d){var e,f=[];return d=d||function(a){return a()},c.isEditing=a.observable(!1),c.beginEdit=function(){c.isEditing()||(e=b,f.push(d(c)),c.isEditing(!0))},c.endEdit=function(){c.isEditing()&&c.isEditing(!1)},c.cancelEdit=function(){c.isEditing()&&f.length&&(e=c(),c(f.pop()),c.isEditing(!1))},c.undoCancel=function(){if(e!==b){var a=e;c.beginEdit(),c(a),e=b}},c.rollback=function(){f.length&&(e=b,c(f.pop()))},c}a.editable=function(b){return c(a.observable(b))},a.editableArray=function(b){return c(a.observableArray(b||[]),function(a){return a.slice()})};var d=function(b,c){for(var d in b)if(b.hasOwnProperty(d)){var e=b[d];e&&e.isEditing&&c(e);var f=a.utils.unwrapObservable(e);if(f&&f.length)for(var g=0;g<f.length;g++)f[g]&&f[g].isEditing&&c(f[g])}};a.editable.makeEditable=function(b){if(!b)throw"Target must be specified";b.isEditing=a.observable(!1),b.beginEdit=function(){(!b.isEditable||b.isEditable())&&(d(b,function(a){a.beginEdit()}),b.isEditing(!0))},b.endEdit=function(){d(b,function(a){a.endEdit()}),b.isEditing(!1)},b.cancelEdit=function(){d(b,function(a){a.cancelEdit()}),b.isEditing(!1)},b.rollback=function(){d(b,function(a){a.rollback()})}}}(c),function(a,b){b.bindingHandlers.loadingWhen={init:function(c,d,e){var f=b.utils.unwrapObservable(e()).loaderClass||"loader-white",g=a(c),h=g.css("position"),i=a("<div>",{"class":f}).addClass("loader").hide();g.append(i),("auto"===h||"static"===h)&&g.css("position","relative")},update:function(c,d){var e=b.utils.unwrapObservable(d()),f=a(c),g=f.children(":not(div.loader)"),h=f.find("div.loader");e?(g.css("visibility","hidden").attr("disabled","disabled"),h.show()):(h.fadeOut("fast"),g.css("visibility","visible").removeAttr("disabled"))}}}(jQuery,c)})}(window);